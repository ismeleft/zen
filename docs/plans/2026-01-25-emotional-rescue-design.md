# 情緒急救流程設計文件

## 概述

為 Zen 應用新增「情緒急救」功能，幫助用戶擺脫負面情緒。採用「先穩定身體，再處理思緒」的神經科學原理，結合身體放鬆技巧與認知覺察練習。

---

## 品牌理念：守護你的光

靈感來源：Jennie《Zen》

> *"Nobody gon' move my soul, gon' move my aura, my matter*
> *Nobody gon' move my light, gon' touch my glow, my matter"*

### 核心概念

這段歌詞傳達「內在穩定、不被外界動搖」的力量——正好呼應神經可塑性中「打破負面循環」的理念。整個應用以「守護你的光芒」為主題，情緒急救流程就是幫助用戶重新找回並穩固自己的內在光芒。

### 視覺語言：柔和漸層光暈

採用類似日出的柔和光芒效果，從中心向外漸層擴散，營造溫暖療癒的氛圍。

**應用場景**：
| 場景 | 光暈效果 |
|------|----------|
| 情緒選擇前 | 微弱、暗淡的光暈（代表需要被守護） |
| 放鬆練習中 | 光暈隨呼吸脈動，逐漸增強 |
| 完成階段 | 飽滿、溫暖的光環包圍（代表光芒被守護住了） |

**CSS 實現方向**：
```css
.aura-glow {
  background: radial-gradient(
    circle,
    rgba(255, 223, 186, 0.6) 0%,    /* 溫暖的中心 */
    rgba(255, 200, 150, 0.3) 40%,   /* 柔和過渡 */
    rgba(255, 180, 120, 0.1) 70%,   /* 外圍漸淡 */
    transparent 100%
  );
  animation: pulse 4s ease-in-out infinite;
}
```

### 文案語言

| 時機 | 文案範例 |
|------|----------|
| 進入流程 | 「讓我們一起守護你的光」 |
| 放鬆階段 | 「穩住你的氣場」 |
| 檢查點（好轉）| 「你的光芒正在回來」 |
| 完成階段 | 「No one can move your light」 |
| 鼓勵語 | 「你的靈魂比你想像的更強大」 |

---

## 設計決策

| 面向 | 決定 |
|------|------|
| 目標階段 | 擺脫負面情緒（神經可塑性第一階段） |
| 功能類型 | 認知覺察練習 + 引導式冥想/放鬆 |
| 使用情境 | 情境引導模式（評估狀態 → 推薦練習） |
| 評估方式 | 簡單情緒選擇（六種情緒圖示） |
| 放鬆技巧 | 組合式（呼吸 + 接地 + 視覺化） |
| 認知練習 | 引導式提問 |
| 流程節奏 | 漸進解鎖（狀態改善可提前結束） |
| UI 架構 | 單頁流程，動畫過渡 |
| 狀態管理 | zustand（可選）或 useReducer |

---

## 元件架構

```
src/components/
├── EmotionalRescue/
│   ├── EmotionalRescue.tsx      # 主流程控制器
│   ├── EmotionalRescue.css
│   ├── EmotionSelector.tsx      # 情緒選擇介面
│   ├── RelaxationPhase.tsx      # 身體放鬆階段
│   ├── CheckInPrompt.tsx        # 狀態檢查點
│   ├── CognitivePhase.tsx       # 認知提問階段
│   └── CompletedPhase.tsx       # 完成階段
```

---

## 流程狀態機

```
[idle] → [selecting] → [relaxing] → [checking] → [reflecting] → [completed]
                                        ↓
                                   [completed]  (如果用戶感覺好轉)
```

---

## 階段一：情緒選擇 (EmotionSelector)

### 六種情緒

| 情緒 | 英文 key | 圖示建議 |
|------|----------|----------|
| 焦慮 | `anxious` | 😰 或漩渦圖形 |
| 憤怒 | `angry` | 😤 或火焰圖形 |
| 悲傷 | `sad` | 😢 或雨滴圖形 |
| 疲憊 | `exhausted` | 😩 或低電量圖形 |
| 混亂 | `overwhelmed` | 🤯 或糾結線條 |
| 孤獨 | `lonely` | 🥀 或單獨圓點 |

### 🏋️ 你來定義

- 情緒類型的 TypeScript type（提示：可以用 union type 或 enum）
- 情緒選項的資料結構（每個情緒需要 key、顯示名稱、圖示）

### 🎯 你來實作

- 點擊情緒後的 callback 處理
- 選中狀態的視覺回饋（例如：放大、邊框高亮）

---

## 階段二：身體放鬆 (RelaxationPhase)

### 三種放鬆技巧模組

**1. 呼吸練習**
- 4-7-8 放鬆呼吸（焦慮、悲傷）
- 長呼氣呼吸：吸4秒、呼8秒（憤怒）
- 能量呼吸：快吸快呼（疲憊）
- 方形呼吸：吸4、停4、呼4、停4（混亂、孤獨）

**2. 五感接地練習（5-4-3-2-1）**
- 引導用戶注意：5個看到的、4個摸到的、3個聽到的、2個聞到的、1個嚐到的
- 適合：焦慮、混亂

**3. 視覺化引導**
- 安全空間想像：引導文字 + 蓮花動畫
- 適合：悲傷、孤獨、疲憊

### 情緒 → 技巧組合對應表

| 情緒 | 組合 |
|------|------|
| 焦慮 | 接地練習 → 4-7-8 呼吸 |
| 憤怒 | 長呼氣呼吸（3 輪）|
| 悲傷 | 4-7-8 呼吸 → 安全空間視覺化 |
| 疲憊 | 能量呼吸 → 視覺化引導 |
| 混亂 | 接地練習 → 方形呼吸 |
| 孤獨 | 方形呼吸 → 安全空間視覺化 |

### 🏋️ 你來定義

- 放鬆技巧類型的 type（`grounding`、`breathing`、`visualization`）
- 呼吸模式的設定結構（吸氣秒數、停留秒數、呼氣秒數等）
- 情緒對應放鬆組合的 mapping 資料結構

### 🎯 你來實作

- 根據情緒查找對應技巧組合的函式
- 多步驟技巧的順序控制邏輯（完成第一個 → 自動進入第二個）
- 重構現有 BreathingExercise，抽出可復用的計時器邏輯

---

## 階段三：狀態檢查 (CheckInPrompt)

### 介面設計

- 簡單問句：「現在感覺如何？」
- 三個選項：
  - 😊 「好多了」→ 直接進入完成階段
  - 😐 「還好」→ 進入認知提問
  - 😔 「還是很難受」→ 進入認知提問

### 🎯 你來實作

- 根據用戶選擇決定下一步的邏輯

---

## 階段四：認知提問 (CognitivePhase)

### 提問流程（3-5 題）

| 順序 | 問題範例 | 目的 |
|------|----------|------|
| 1 | 「現在腦中最大的那個想法是什麼？」 | 覺察 |
| 2 | 「這個想法是事實，還是一種感覺？」 | 區分事實與詮釋 |
| 3 | 「如果朋友有這個想法，你會對他說什麼？」 | 自我慈悲 |
| 4 | 「最壞的情況發生的機率有多高？」 | 挑戰災難化（焦慮適用）|
| 5 | 「此刻有什麼是你能控制的？」 | 聚焦可控 |

### 互動方式

- 每次顯示一題
- 用戶不需輸入文字，只需在心中回答
- 點擊「下一步」或等待數秒後自動前進
- 可顯示小提示輔助思考

### 🏋️ 你來定義

- 問題資料結構（問題文字、適用情緒、可選提示）
- 情緒對應問題清單的 mapping

### 🎯 你來實作

- 根據情緒篩選適用問題的函式
- 問題輪播的索引控制邏輯
- 自動前進的計時器

---

## 階段五：完成 (CompletedPhase)

### 顯示內容

- 飽滿的光暈效果包圍畫面（守護光芒的視覺高潮）
- 主標語：「No one can move your light」
- 根據情緒顯示對應的鼓勵語
- 顯示完成的練習摘要
- 蓮花動畫呈現平靜狀態，周圍有柔和光暈
- 「返回首頁」按鈕

### 🎯 你來實作

- 根據情緒選擇鼓勵語的函式
- 光暈強度漸變動畫（從弱到強）

---

## 主元件整合 (EmotionalRescue)

### 需要追蹤的狀態

- 當前流程階段（selecting / relaxing / checking / reflecting / completed）
- 選擇的情緒
- 放鬆階段的進度（第幾個技巧、技巧內的步驟）
- 認知階段的問題索引

### 🏋️ 你來定義

- 流程階段的 type
- 整體狀態的 interface
- zustand store 結構（如果使用）

### 🎯 你來實作

- 流程階段切換的邏輯
- 各階段完成時的 callback 串接

---

## 技術備註

- **狀態管理**：建議使用 zustand，方便跨元件共享狀態
- **計時器**：可參考現有 BreathingExercise 的 setTimeout 模式
- **測試**：使用 TDD，先寫測試再實作
- **樣式**：CSS 檔案與元件同層放置
